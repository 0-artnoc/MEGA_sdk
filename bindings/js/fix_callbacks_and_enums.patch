--- tools/webidl_binder.py.orig	2015-11-22 03:26:23.352590876 +0100
+++ tools/webidl_binder.py	2015-11-23 01:54:27.778906621 +0100
@@ -80,7 +80,7 @@
 %s.prototype.__class__ = %s;
 %s.__cache__ = {};
 Module['%s'] = %s;
-''' % (name, 'Object.create(%s.prototype)' % (implements[name][0] if implements.get(name) else 'WrapperObject'), name, name, name, name, name, name, name)]
+''' % (name, 'Object.create(%s.prototype)' % (name if implements.get(name) else 'WrapperObject'), name, name, name, name, name, name, name)]
 
 
 mid_js += ['''
@@ -252,7 +252,7 @@
   return ''
 
 def type_to_cdec(raw):
-  name = ret = type_to_c(raw.type.name, non_pointing=True)
+  name = ret = type_to_c(raw.type.name, non_pointing=False)
   if raw.getExtendedAttribute('Const'): ret = 'const ' + ret
   if name not in interfaces: return ret
   if raw.getExtendedAttribute('Ref'):
@@ -453,7 +453,7 @@
           func_name, class_name, func_name,
           return_prefix,
           func_name,
-          ','.join(['$%d' % i for i in range(1, max_args + 1)]),
+          ','.join(['wrapPointer($%d, %s)' % (i, raw[i-1].type.name) for i in range(1, max_args + 1)]),
           return_postfix,
           (', ' if js_call_args else '') + js_call_args)]
 
@@ -632,6 +632,9 @@
 }
 ''' % (name, function_id, value)]
     symbols = value.split('::')
+    while len(symbols) > 2:
+      symbols.pop(0);
+
     if len(symbols) == 1:
       identifier = symbols[0]
       deferred_js += ["Module['%s'] = _emscripten_enum_%s();\n" % (identifier, function_id)]
