# applications
TESTS = tests/test_unit tests/test_integration tests/test_purge_account

if BUILD_TESTS
noinst_PROGRAMS += $(TESTS)
endif

# depends on libmega
$(TESTS): $(top_builddir)/src/libmega.la

# rules
tests_test_unit_SOURCES = \
    tests/unit/commands_test.cpp \
    tests/unit/crypto_test.cpp \
    tests/unit/json_test.cpp \
    tests/unit/main.cpp \
    tests/unit/megaapi_test.cpp \
    tests/unit/paycrypt_test.cpp

tests_test_integration_SOURCES = \
    tests/integration/main.cpp \
    tests/integration/sdk_test.cpp \
    tests/integration/sync_test.cpp

tests_test_purge_account_SOURCES = \
    tests/manual/purge_account.cpp

tests_test_unit_CXXFLAGS = -I$(GTEST_DIR)/include $(FI_CXXFLAGS) $(RL_CXXFLAGS) $(ZLIB_CXXFLAGS) $(CARES_FLAGS) $(LIBCURL_FLAGS) $(CRYPTO_CXXFLAGS) $(DB_CXXFLAGS) $(SODIUM_CXXFLAGS) $(LIBSSL_FLAGS)
tests_test_unit_LDADD = $(GTEST_DIR)/lib/libgtest.la $(GTEST_DIR)/lib/libgtest_main.la $(CRYPTO_LIBS) $(SODIUM_LDFLAGS) $(SODIUM_LIBS) $(top_builddir)/src/libmega.la

tests_test_integration_CXXFLAGS = -I$(GTEST_DIR)/include -I$(top_builddir)/include $(FI_CXXFLAGS) $(RL_CXXFLAGS) $(ZLIB_CXXFLAGS) $(CARES_FLAGS) $(LIBCURL_FLAGS) $(CRYPTO_CXXFLAGS) $(DB_CXXFLAGS) $(SODIUM_CXXFLAGS) $(LIBSSL_FLAGS)
tests_test_integration_LDADD = $(GTEST_DIR)/lib/libgtest.la $(GTEST_DIR)/lib/libgtest_main.la $(CRYPTO_LIBS) $(SODIUM_LDFLAGS) $(SODIUM_LIBS) $(top_builddir)/src/libmega.la

tests_test_purge_account_CXXFLAGS = -I$(top_builddir)/include $(FI_CXXFLAGS) $(RL_CXXFLAGS) $(ZLIB_CXXFLAGS) $(CARES_FLAGS) $(LIBCURL_FLAGS) $(CRYPTO_CXXFLAGS) $(DB_CXXFLAGS) $(SODIUM_CXXFLAGS) $(LIBSSL_FLAGS)
tests_test_purge_account_LDADD = $(top_builddir)/src/libmega.la
